SELECT
	JOB, BATCH , SEQ#, PART, 
	SUM(CASE SOURCE WHEN 'JCSTM-STDM' THEN QTY ELSE 0 END) QTY_STD_JCST,
	SUM(CASE SOURCE	WHEN 'PDGL-STDM' THEN QTY ELSE 0 END) QTY_STD_PDGL,
	SUM(CASE SOURCE	WHEN 'JCSTT-ACTM' THEN QTY ELSE 0 END) QTY_ACT_JCST,
	SUM(CASE SOURCE	WHEN 'PDGL-ACTM' THEN QTY ELSE 0 END) QTY_ACT_PDGL,
	SUM(CASE SOURCE WHEN 'JCSTM-STDM' THEN COST ELSE 0 END) COST_STD_JCST,
	SUM(CASE SOURCE	WHEN 'PDGL-STDM' THEN COST ELSE 0 END) COST_STD_PDGL,
	SUM(CASE SOURCE	WHEN 'JCSTT-ACTM' THEN COST ELSE 0 END) COST_ACT_JCST,
	SUM(CASE SOURCE	WHEN 'PDGL-ACTM' THEN COST ELSE 0 END) COST_ACT_PDGL
FROM
	(
		SELECT
			'JCSTM-STDM' SOURCE, CCJOBN JOB, CCBTCH BATCH, CCOSEQ SEQ#, CCMPAR PART, CCQTY QTY, CCTCOS COST
		FROM 
			LGDAT.JCSTM S
		WHERE 
			CCBTCH = 380006 AND 
			CCJOBN = '152022799'
			
		UNION ALL
		
		SELECT
			'PDGL-STDM' SOURCE, WRKO JOB, BTID BATCH, SEQ#, PART, -SUM(PQTY) QTY, -SUM(AMNT) COST 
		FROM
			RLARP.FFPDGLR1
		WHERE
			BTID = 380006 AND 
			WRKO = '152022799' AND
			ACTN IN ('SBG','SBS')
		GROUP BY
			WRKO, BTID, SEQ#, PART
			
		UNION ALL
		
		SELECT
			'PDGL-ACTM' SOURCE, WRKO JOB, BTID BATCH, SEQ#, PART, -PQTY QTY, -AMNT COST
		FROM
			RLARP.FFPDGLR1
		WHERE
			BTID = 380006 AND 
			WRKO = '152022799' AND
			ACTN IN ('BMT')
			
		UNION ALL
		
		SELECT
			'JCSTT-ACTM' SOURCE, FZJOBN JOB , FZBTCH BATCH, FZOSEQ SEQ#, FZMPAR PART, FZQTY QTY, FZTCOS COST
		FROM 
			LGDAT.JCSTT S
		WHERE 
			FZBTCH = 380006 AND 
			FZJOBN = '152022799'
	) X
GROUP BY
	JOB, BATCH , SEQ#, PART