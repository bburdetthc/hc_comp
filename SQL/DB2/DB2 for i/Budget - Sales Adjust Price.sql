
-----------------------------PRICE NORMALIZATION--------------------------------

SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    0 QTY,
    VALUE_LOCAL * 
    CASE MAJG 
        WHEN '110 - INJECTION' THEN .135 
        WHEN '320 - COEX' THEN .135 
        WHEN '310 - VACUUM FORM' THEN .095 
        ELSE 0
    END VALUE_LOCAL,
    0 PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Greenhouse Pricelist Adj for Baseline'
FROM 
	QGPL.FFBS0403 
WHERE 
    VERSION = 'BASELINE' AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
    SHIPCUSTCLASS LIKE '%DIS%' AND
    MAJG IN ('110 - INJECTION','320 - COEX','310 - VACUUM FORM') AND
	(B_ORDERDATE + I_ORDERDATE DAYS) >= '2017-06-01' AND 
	(B_ORDERDATE + I_ORDERDATE DAYS) <= '2017-12-31'


-------------------LOBLAWS RISK-----------------------------------------------------
DELETE FROM QGPL.FFBS0403 WHERE VERSION = 'Loblaw''s Risk';
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    -QTY QTY,
    -VALUE_LOCAL VALUE_LOCAL,
    0 PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Loblaw''s Risk'
FROM 
	QGPL.FFBS0403 
WHERE 
    VERSION IN ('Greenhouse Pricelist Adj for Baseline','BASELINE') AND
	PROMO LIKE 'LOBLAWS 2017%' AND 
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
	B_SHIPDATE + I_SHIPDATE DAYS >= '2017-06-01' AND
    B_ORDERDATE + I_ORDERDATE DAYS >= '2017-05-01'

-------------------DISTRIBUTION VOLUME-----------------------------------------------------
DELETE FROM QGPL.FFBS0403 WHERE VERSION = 'Distribution Volume Risk';
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    -QTY*.05 QTY,
    -VALUE_LOCAL*.05 VALUE_LOCAL,
    PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Distribution Volume Risk'
FROM 
	QGPL.FFBS0403 
WHERE 
	BILLCUSTCLASS IN ('GDIS','NDIS') AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
	B_ORDERDATE + I_ORDERDATE DAYS >= '2017-05-01';

-------------------DIRECT VOLUME-----------------------------------------------------
DELETE FROM QGPL.FFBS0403 WHERE VERSION = 'Direct Volume Risk';
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    -QTY*.1 QTY,
    -VALUE_LOCAL*.1 VALUE_LOCAL,
    PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Direct Volume Risk'
FROM 
	QGPL.FFBS0403 
WHERE 
	BILLCUSTCLASS IN ('GDIR','GDRP','NDIR') AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
	B_ORDERDATE + I_ORDERDATE DAYS >= '2017-05-01';

-------------------Lowes & Wal-Mart Price-----------------------------------------------------
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    0 QTY,
    VALUE_LOCAL*.04 VALUE_LOCAL,
    0 PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Lowes & Wal-Mart Price'
FROM 
	QGPL.FFBS0403 
WHERE 
    VERSION IN ('Greenhouse Pricelist Adj for Baseline','BASELINE') AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
	SUBSTR(PART,1,8) IN ('PSC0800','PSH1000','PSP1000','HMH1000','HMP1000','QUH1000','FSH1000','QUP1000') AND
	B_ORDERDATE + I_ORDERDATE DAYS >= '2017-05-01';

------------lobllaws price gain---------------
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    0 QTY,
    VALUE_LOCAL*.1875 VALUE_LOCAL,
    0 PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'Loblaw''s Win'
FROM 
	QGPL.FFBS0403 
WHERE 
    VERSION IN ('Greenhouse Pricelist Adj for Baseline','BASELINE') AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
	PROMO LIKE 'LOBLAWS 2017%' AND 
	B_ORDERDATE + I_ORDERDATE DAYS >= '2017-05-01'

------------Weathered Wood---------------
DELETE FROM QGPL.FFBS0403 WHERE VERSION = 'X1000 Weathered Wood';
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    QTY*4.58517-QTY,
    VALUE_LOCAL*4.58517-VALUE_LOCAL VALUE_LOCAL,
    PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    'X1000 Weathered Wood'
FROM 
	QGPL.FFBS0403 
WHERE 
    PART LIKE 'PBH1200%' AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
    VERSION IN ('Greenhouse Pricelist Adj for Baseline','BASELINE') AND
	B_SHIPDATE + I_SHIPDATE DAYS >= '2017-06-01' AND
    B_SHIPDATE + I_SHIPDATE DAYS < '2018-06-01' AND
    B_ORDERDATE + I_ORDERDATE DAYS >= '2017-06-01'

------------6 ct Tray---------------
INSERT INTO 
	QGPL.FFBS0403
SELECT 
    PLNT,
    ORDER,
    ORDERITEM,
    BOL,
    BOLITEM,
    INVOICE,
    INVOICEITEM,
    PROMO,
    RETURNREAS,
    TERMS,
    CUSTPO,
    ORDERDATE,
    REQUESTDATE,
    PROMISEDATE,
    SHIPDATE,
    SALESMONTH,
    BILLREMITO,
    BILLCUSTCLASS,
    BILLCUST,
    BILLREP,
    BILLDSM,
    BILLDIRECTOR,
    SHIPCUSTCLASS,
    SHIPCUST,
    SHIPDSM,
    SHIPDIRECTOR,
    SPECIAL_SAUCE_REP,
    ACCOUNT,
    GEO,
    CHAN,
    ORIG_CTRY,
    ORIG_PROV,
    ORIG_LANE,
    ORIG_POST,
    DEST_CTRY,
    DEST_PROV,
    DEST_LANE,
    DEST_POST,
    PART,
    GL_CODE,
    MAJG,
    MING,
    MAJS,
    MINS,
    GLDC,
    GLEC,
    HARM,
    CLSS,
    BRAND,
    ASSC,
    STATEMENT_LINE,
    R_CURRENCY,
    R_RATE,
    C_CURRENCY,
    C_RATE,
    QTY*6.532696-QTY,
    VALUE_LOCAL*6.532696-VALUE_LOCAL VALUE_LOCAL,
    PRICE,
    STATUS,
    FLAG,
    B_ORDERDATE,
    B_REQUESTDATE,
    B_SHIPDATE,
    I_ORDERDATE,
    I_REQUESTDATE,
    I_SHIPDATE,
    '6 ct Tray'
FROM 
	QGPL.FFBS0403 
WHERE 
    PART LIKE 'TIS6665%' AND
    GLEC = '1GR - GREENHOUSE PRODUCT' AND
    VERSION IN ('Greenhouse Pricelist Adj for Baseline','BASELINE') AND
	B_SHIPDATE + I_SHIPDATE DAYS >= '2017-06-01' AND
    B_SHIPDATE + I_SHIPDATE DAYS < '2018-06-01' AND
    B_ORDERDATE + I_ORDERDATE DAYS >= '2017-06-01'