SELECT
	*
FROM
(
SELECT
	DIGLCD, DHCOMP, Y1INVA AS INVENTORY,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	ROUND(COALESCE(CHSTCS, CGSTCS, Y0STCS)*DIQTSH*COALESCE(IHCNV2,1),2) D,0 C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI
WHERE
	DHARYR = 16 AND
	DHARPR = 6 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0
UNION ALL

SELECT
	DIGLCD, DHCOMP, FLOAT(SUBSTR(ZWEXM#,3,10)) AS MATCOS,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	0 D,ROUND(COALESCE(CGMATS, CHSTCS, Y0SMAT+Y0SSHC+Y0SOC)*DIQTSH*COALESCE(IHCNV2,1),2) AS C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI

WHERE
	DHARYR = 16 AND
	DHARPR = 5 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0

UNION ALL

SELECT
	DIGLCD, DHCOMP,FLOAT(SUBSTR(ZWELB#,3,10)) LABCOS,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	0 D,ROUND(COALESCE(CGLABS, Y0SLAB, 0)*DIQTSH*COALESCE(IHCNV2,1),2) AS C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI

WHERE
	DHARYR = 16 AND
	DHARPR = 5 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0
UNION ALL

SELECT
	DIGLCD, DHCOMP, FLOAT(SUBSTR(ZWEXBF,3,10)) AS FIXCOS,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	0 D,ROUND(COALESCE(CGBRFS, Y0SFBR, 0)*DIQTSH*COALESCE(IHCNV2,1),2) AS C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI

WHERE
	DHARYR = 16 AND
	DHARPR = 5 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0

UNION ALL

SELECT
	DIGLCD, DHCOMP,FLOAT(SUBSTR(ZWEXB#,3,10)) AS VARCOS,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	0 D,ROUND(COALESCE(CGBRVS, Y0SVBR, 0)*DIQTSH*COALESCE(IHCNV2,1),2) AS C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI

WHERE
	DHARYR = 16 AND
	DHARPR = 5 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0
UNION ALL

SELECT
	DIGLCD, DHCOMP, FLOAT(SUBSTR(ZWEXO#,3,10)) AS OTHCOS,
	DIGITS(DHINV#)||'-'||DIGITS(DILIN#) INVLINE, 
	0 D,ROUND(COALESCE(CGSTOC, Y0SOTC, 0)*DIQTSH*COALESCE(IHCNV2,1),2) AS C,
	'',DIPART,'','','','','','',DHBCS#,'','',310
FROM
	LGDAT.OIH
	INNER JOIN LGDAT.OID ON
		DHINV# = DIINV#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.ARMASC ON
		ZWCOMP = DHCOMP AND
		ZWPLNT = DHPLNT AND
		ZWKEY1 = BVARCD AND
		ZWKEY2 = DIGLCD
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = DIPART AND
		CHPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = DIPART AND
		CGPLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = DIPART AND
		Y0PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = DIPART
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = DIPART
	LEFT OUTER JOIN LGDAT.GLIE ON
		Y1PLNT = DHPLNT AND 
		Y1GLEC = COALESCE(AVGLED, AWGLED) 
	LEFT OUTER JOIN LGDAT.STKA ON
		V6PART = DIPART AND
		V6PLNT = DHPLNT
	LEFT OUTER JOIN LGDAT.PUNIT ON
		IHPART = DIPART AND
		IHUNT1 = DIUNIT AND
		IHUNT2 = V6UNTI

WHERE
	DHARYR = 16 AND
	DHARPR = 5 AND
	DHINCR = 'C' AND DIPART <> '' AND DIQTSH <> 0
) X
WHERE
	X.D+X.C<>0
ORDER BY INVLINE