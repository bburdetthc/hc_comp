SELECT
	'STKT' SRCE, BYPLNT,  BYJREF, CHAR(BYSDAT) BYSDAT, CHAR(BYSTIM) BYSTIM, BYPART, 
	BYQTY*CASE BYACTN WHEN 'I' THEN -1 ELSE 1 END BYQTY,
	BYQTY*CASE BYACTN WHEN 'I' THEN -1 ELSE 1 END*COALESCE(FCOST, CGSTCS, CHSTCS, Y0STCS) COST
FROM
	LGDAT.STKT
	LEFT OUTER JOIN QGPL.FFCOSTEFFD ON
		PART = BYPART AND
		PLNT = BYPLNT AND
		CHAR(FDT)||CHAR(FTM) <= CHAR(BYSDAT)||CHAR(BYSTIM) AND
		CHAR(TDT)||CHAR(TTM) >= CHAR(BYSDAT)||CHAR(BYSTIM)
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = BYPART AND
		CGPLNT = BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = BYPART AND
		CHPLNT = BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = BYPART AND
		Y0PLNT = BYPLNT
WHERE
	BYJREF = 'X008160619'

UNION ALL

SELECT
	'PDGL' SRCE, SUBSTR(ADEP,1,3) PLNT, WRKO, CHAR(NWUDAT) NWCDAT, CHAR(NWUTIM) NWCTIM, PART, PQTY, AMNT
FROM
	QGPL.FFPDGLR1
	INNER JOIN LGDAT.RPRH ON
		NWBTID = BTID
WHERE
	SUBSTR(ACCT,7,4) IN ('1200','1220') AND
	WRKO = 'X008160619'