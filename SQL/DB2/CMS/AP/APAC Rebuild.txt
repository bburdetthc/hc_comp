SELECT 
	D07TXN, D07RKEY, D07FSPR, D07AMT, KRCOM#||DIGITS(D07GLAC) ACCT, D07UUSR, KRPT#, KRDESC, KRVEN#, KRPO#, KRPOI#, CHAR(KRRDAT) KRRDAT,
	KRBQTY, KRPST, KRGST, KRGST2, KROPST, KRRCVX, KREXT, KRSCST, KRSUC, KREXT/KRBQTY EXT, KRAPRC, 
	((KREXT+KRPST)/KRBQTY*FLOAT(KRRCVX)-KRSCST)*KRBQTY PPV,
	CASE WHEN D07AMT < 0 THEN -1 ELSE 1 END*ROUND(ABS(((KREXT+KRPST)/KRBQTY*FLOAT(KRRCVX)-KRSCST)*KRBQTY),2) TRN_AMT
FROM 
	QGPL.FFPORCAG G
	LEFT OUTER JOIN QGPL.FFPORCAP P ON
		SUBSTR(D07FSPR,3,4) = FISC AND
		D07RKEY = KRRKEY
WHERE
	D07FSPR = 201503
FETCH FIRST 10 ROWS ONLY