SELECT
	BXPLNT,
	YACOMP||Y1INVA AS ACCT,
	BXPART,
	COALESCE(AVDES1, AWDES1) AS DESCR,
	V6STAT,
	V6RPLN,
	BXSTOK,
	COALESCE(AWGLED, AVGLED) ,
	COALESCE(AWMAJG, AVMAJG) ,
	COALESCE(AWMING, AVMING) ,
	BXQTOH,
	COALESCE(CGSTCS, CHSTCS, Y0STCS)*BXQTOH  AS EXTCOST
FROM
	LGDAT.STKB
	INNER JOIN LGDAT.STKA ON
		V6PART = BXPART AND
		V6PLNT = BXPLNT
	LEFT OUTER JOIN LGDAT.ICSTP ON
		CHPART = BXPART AND
		CHPLNT = BXPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ON
		CGPART = BXPART AND
		CGPLNT = BXPLNT
	LEFT OUTER JOIN LGDAT.ICSTR ON
		Y0PART = BXPART AND
		Y0PLNT = BXPLNT
	LEFT OUTER JOIN LGDAT.STKMM ON
		AVPART = BXPART 
	LEFT OUTER JOIN LGDAT.STKMP ON
		AWPART = BXPART
	LEFT OUTER JOIN LGDAT.GLIE A ON
		Y1GLEC = COALESCE(AVGLED, AWGLED) AND
		Y1PLNT = BXPLNT
	LEFT OUTER JOIN LGDAT.PLNT L ON
		YAPLNT = BXPLNT

WHERE
	BXPLNT IN ('155') AND
	BXPART <> '' AND
	COALESCE(CGSTCS, CHSTCS, Y0STCS)*BXQTOH<> 0