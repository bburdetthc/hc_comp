SELECT
	YACOMP||Y1INVA AS ACCT,
	BYPART, BYPLNT, CHAR(BYTDAT) BYTDAT,
	SUBSTR(BYJREF,5,6) AS PO,
	SUBSTR(BYDREF,25,6) AS RLG,
	BYQTY*CASE BYACTN WHEN 'I' THEN -1 ELSE 1 END AS QTY,
	BYQTY*CASE BYACTN WHEN 'I' THEN -1 ELSE 1 END*COALESCE(CGSTCS, CHSTCS, Y0STCS) AS STCS
FROM
	LGDAT.STKT STKT
	LEFT OUTER JOIN LGDAT.ICSTP P ON
		CHPART = STKT.BYPART AND
		CHPLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTM M ON
		CGPART = STKT.BYPART AND
		CGPLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTR R ON
		Y0PART = STKT.BYPART AND
		Y0PLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.STKMP MP ON
		MP.AWPART = BYPART
	LEFT OUTER JOIN LGDAT.STKMM MM ON
		MM.AVPART = BYPART
	LEFT OUTER JOIN LGDAT.GLIE A ON
		Y1GLEC = COALESCE(AVGLED, AWGLED) AND
		Y1PLNT = BYPLNT
	LEFT OUTER JOIN LGDAT.PLNT L ON
		YAPLNT = BYPLNT
WHERE
	CASE STKT.BYSRC WHEN 'OE' THEN  'OE'||UPPER(SUBSTRING(BYDREF,1,3)) ELSE BYSRC END = 'PO ' AND
	BYFSYY = 2013 AND
	BYFSPR	= 12 AND
	BYTDAT = '2013-12-12'
FETCH FIRST 10 ROWS ONLY