SELECT 
	YACOMP||Y1INVA AS ACCT,
	CHAR(BYTDAT) BYTDAT, BYJREF, BYDREF, BYPART,
	SUBSTR(BYDREF,5,9) INVOICE,
	SUBSTR(BYDREF,15,3) LINE,
	BYQTY,
	BYQTY*CASE BYACTN WHEN 'I' THEN -1 ELSE 1 END*COALESCE(CGSTCS, CHSTCS,Y0STCS) STCS
FROM 
	LGDAT.STKT STKT
	LEFT OUTER JOIN LGDAT.ICSTP P ON
		CHPART = STKT.BYPART AND
		CHPLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTM M ON
		CGPART = STKT.BYPART AND
		CGPLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.ICSTR R ON
		Y0PART = STKT.BYPART AND
		Y0PLNT = STKT.BYPLNT
	LEFT OUTER JOIN LGDAT.STKMP MP ON
		MP.AWPART = BYPART
	LEFT OUTER JOIN LGDAT.STKMM MM ON
		MM.AVPART = BYPART
	LEFT OUTER JOIN LGDAT.GLIE A ON
		Y1GLEC = COALESCE(AVGLED, AWGLED) AND
		Y1PLNT = BYPLNT
	LEFT OUTER JOIN LGDAT.PLNT L ON
		YAPLNT = BYPLNT
WHERE
	STKT.BYFSYY = 2014 AND 
	STKT.BYFSPR = 1 AND 
	STKT.BYACTN IN ('I','R') AND
	BYPLNT = '152' AND
	CASE STKT.BYSRC WHEN 'OE' THEN  'OE'||UPPER(SUBSTRING(BYDREF,1,3)) ELSE BYSRC END = 'OEINV'
FETCH FIRST 10 ROWS ONLY