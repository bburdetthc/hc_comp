WITH RECURSIVE PPE(MPART, MPLNT, TLVL, LVL,PART, PLNT, STAT, RPLN, TPLN)
AS
(
	SELECT
		V6PART, V6PLNT,
		DIGITS(int(ROW_NUMBER() OVER ())),
		0,
		V6PART,
		V6PLNT,
		V6STAT, 
		V6RPLN,
		V6TPLN
	FROM
		LGDAT.STKA B
	WHERE
		B.V6RPLN = 3 AND
		B.V6STAT = 'A'
	
	UNION ALL
	
	SELECT
		MPART, MPLNT,
		PPE.TLVL,
		PPE.LVL+1,
		V6PART,
		V6PLNT,
		V6STAT,
		V6RPLN,
		V6TPLN
	FROM
		PPE PPE
		INNER JOIN LGDAT.STKA ON
			V6PART = PPE.PART AND
			V6PLNT = PPE.TPLN
	WHERE
		PPE.LVL < 10
)
SELECT
	MPART, MPLNT, TLVL, REPEAT('. ',LVL)|| LVL AS XLVL, PART, PLNT, STAT, RPLN, TPLN
FROM
	PPE
ORDER BY
	TLVL, LVL
FETCH FIRST 100 ROWS ONLY