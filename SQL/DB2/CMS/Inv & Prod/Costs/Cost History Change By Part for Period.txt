SELECT
	JHPART, JHPLNT, CHAR(JHDATE) JHDATE, CHAR(JHTIME) JHTIME, SUM(JHTOTO) JHTOTO, SUM(JHTOTN) JHTOTN, 
	--if either of the following fields are greater than one then do not use
	SUM(CASE JHTOTO WHEN 0 THEN 0 ELSE 1 END),
	SUM(CASE JHTOTN WHEN 0 THEN 0 ELSE 1 END)
FROM
	LGDAT.ICSTT
	INNER JOIN
	(
	SELECT DISTINCT
		BYPART, BYPLNT
	FROM
		LGDAT.STKT
	WHERE
		BYFSYY = 2014 AND
		BYFSPR = 3
	) X ON
		BYPART = JHPART AND
		BYPLNT = JHPLNT AND
		JHDATE >= '2014-03-01' AND
		JHDATE < '2014-04-01' AND
		JHCTYP = 'S'
GROUP BY
	JHPART, JHPLNT, CHAR(JHDATE), CHAR(JHTIME)
FETCH FIRST 200 ROWS ONLY