SELECT
 	UIDEPT, UIRESC, UIPART, UIJOB#, UIBTID, CHAR(UIDATE) AS UIDATE, UISEQ#, UIMTLP, 
	IFNULL(AVMAJG,AWMAJG) MAJG, 
   	IFNULL(AVMING,AWMING)||' - '||RTRIM(MMGP.BRDES) MING, 
	UIRQTY, UITQTY,
  	COALESCE(CGSTCS, CHSTCS, Y0STCS) AS STCS, 
   	UITQTY*CASE UIRQBY WHEN 'B' THEN -1 ELSE 1 END AS QTY,
 	UITQTY*CASE UIRQBY WHEN 'B' THEN -1 ELSE 1 END*COALESCE(CGSTCS, CHSTCS, Y0STCS) AS AMT
FROM 
 	LGDAT.RPRM
	INNER JOIN LGDAT.PRTRAN ON
		IXWRKO = UIJOB# AND
		IXBTCH = UIBTID
 	LEFT OUTER JOIN LGDAT.ICSTP P ON
  		P.CHPART = UIMTLP AND
  		P.CHPLNT = SUBSTR(UIDEPT,1,3)
 	LEFT OUTER JOIN LGDAT.ICSTM M ON
  		M.CGPART = UIMTLP AND
  		M.CGPLNT = SUBSTR(UIDEPT,1,3)
   	LEFT OUTER JOIN LGDAT.ICSTR T ON
  		T.Y0PART = UIMTLP AND
  		T.Y0PLNT = SUBSTR(UIDEPT,1,3)
 	LEFT OUTER JOIN LGDAT.STKMP SP ON
  		SP.AWPART = UIMTLP
 	LEFT OUTER JOIN LGDAT.STKMM SM ON
  		SM.AVPART = UIMTLP
	LEFT OUTER JOIN LGDAT.MMGP MMGP ON
    		MMGP.BRMGRP = COALESCE(AVMING, AWMING) AND
    		MMGP.BRGRP = COALESCE(AVMAJG, AWMAJG) 
WHERE
	IXPART = 'XRD16000X56E001' AND
	SUBSTR(IXDEPT,1,3) = '152' AND
	IXFSYY||DIGITS(IXFSPP) >= '1310'
	