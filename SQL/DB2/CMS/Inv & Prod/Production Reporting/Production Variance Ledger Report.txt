--DECLARE GLOBAL TEMPORARY TABLE WPP (WRKO CHAR(10), PART CHAR(20), PLNT CHAR(3), STAT CHAR(1))
--DECLARE GLOBAL TEMPORARY TABLE JBOM (WRKO CHAR(10), PART CHAR(20), SEQ INT, MTLP CHAR(20), UNIT CHAR(10), QTY FLOAT)
--DECLARE GLOBAL TEMPORARY TABLE WQ (WRKO CHAR(10), PART CHAR(20), 

/*
INSERT INTO 
	QTEMP.WPP
SELECT 						
	DWWREF, DWPART, SUBSTR(DWDEPT,1,3) AS PLNT, 					
	CASE IFNULL(H.DNPLNT,'X') WHEN 'X' THEN 'C' ELSE 'H' END STAT,
	SUM(DWQTYC), SUM(DWQTYS), SUM((DWQTYC+DWQTYS)/FLOAT(DWRATE)) 
FROM						
	LGDAT.PRTRAN					
	LEFT OUTER JOIN LGDAT.CJOBH C ON					
		C.DNJOB = IXWRKO				
	LEFT OUTER JOIN LGDAT.HJOBH H ON					
		H.DNJOB = IXWRKO				
WHERE						
	IXFSYY = 14 AND					
	IXFSPP = 2 AND					
	IXPART <> ''
GROUP BY
	IXWRKO, IXPART, SUBSTR(IXDEPT,1,3), 					
	CASE IFNULL(H.DNPLNT,'X') WHEN 'X' THEN 'C' ELSE 'H' END

*/



/*
INSERT INTO
	QTEMP.JBOM
SELECT 
 	W.WRKO, W.PART, COALESCE(C.EFSEQ#,H.EFSEQ#), 
	COALESCE(C.EFMTLP, H.EFMTLP) MTLP, 
	COALESCE(C.EFUNIT, H.EFUNIT)||' '||V6UNTI AS JOB_STKA,
 	CASE COALESCE(C.EFRQBY, H.EFRQBY) WHEN 'B' THEN -1 ELSE 1 END*
	COALESCE(C.EFQPPC, H.EFQPPC)/
	COALESCE(C.EFQTYM, H.EFQTYM)/
	(1-FLOAT(COALESCE(C.EFSCRP, H.EFSCRP))/100)*IFNULL(CNV1,1)/IFNULL(CNV2,1) AS SCRPQTY
FROM 
	QTEMP.WPP W
 	LEFT OUTER JOIN LGDAT.CJOBDM C ON
		C.EFJOB# = WRKO
	LEFT OUTER JOIN LGDAT.HJOBDM H ON
		H.EFJOB# = WRKO
   	LEFT OUTER JOIN LGDAT.STKA A ON
  		V6PART = COALESCE(C.EFMTLP, H.EFMTLP) AND
  		V6PLNT = W.PLNT
 	LEFT OUTER JOIN 
 	(
  		SELECT 
			IHPART AS PART, IHUNT1 AS UNT1, IHUNT2 AS UNT2, IHCNV1 AS CNV1, IHCNV2 AS CNV2
  		FROM 
			LGDAT.PUNIT PUNIT
  		WHERE 
			PUNIT.IHPART='&&GLOBAL'
  		UNION ALL
  		SELECT 
			IHPART AS PART, IHUNT2 AS UNT1, IHUNT1 AS UNT2, IHCNV2 AS CNV1, IHCNV1 AS CNV2
  		FROM 
			LGDAT.PUNIT PUNIT
  		WHERE 
			PUNIT.IHPART='&&GLOBAL'
 	) X ON
  		V6UNTI = X.UNT1 AND
  		COALESCE(C.EFUNIT, H.EFUNIT) = X.UNT2
*/


