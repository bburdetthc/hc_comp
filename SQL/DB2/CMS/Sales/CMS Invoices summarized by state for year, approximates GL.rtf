SELECT 
	DHSPOV, DHSCRY, DHCOMP, BVCOMP, BVCLAS, 
	SUM(DHTOTI*CASE DHINCR WHEN 'C' THEN -1 ELSE 1 END) AS DHTOTI, 
	SUM(DHTOTD*CASE DHINCR WHEN 'C' THEN -1 ELSE 1 END) AS DHTOTD
FROM 
	LGDAT.OIH 
	LEFT OUTER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
WHERE
	DHARYR = 12
GROUP BY
	DHSPOV, DHSCRY, DHINCR, DHCOMP, BVCOMP, BVCLAS

