SELECT
	DIGLCD, EE.A30 AS SLS_DESCR, DIREAS, RS.A30 AS RS_DESCR, DHINCR, COUNT(DILIN#) AS NUMBER_LINES, SUM(DIEXTN) AS SUM_EXTN
FROM
	LGDAT.OIH
	LEFT OUTER JOIN LGDAT.OID ON
		DIINV# = DHINV#
	LEFT OUTER JOIN LGDAT.CODE EE ON
		EE.A2 = 'EE' AND
		LTRIM(RTRIM(EE.A9)) = DIGLCD
	LEFT OUTER JOIN LGDAT.CUST ON
		BVCUST = DHBCS#
	LEFT OUTER JOIN LGDAT.CODE  RS ON
		RS.A2 = 'RS' AND
		LTRIM(RTRIM(RS.A9)) = DIREAS
WHERE
	DHARYR = 13
GROUP BY
	DIGLCD, EE.A30, DIREAS, DHINCR, RS.A30
ORDER BY 
	DIGLCD