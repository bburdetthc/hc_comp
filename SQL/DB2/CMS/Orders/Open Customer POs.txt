SELECT
	DCPROM, BVCLAS, DCPO, CHAR(DCMDAT) PROMDAT, DCSTAT, DCBCUS||' - '||RTRIM(BVNAME) DCBCUS, DCCURR, 
	SUM(DDTOTI) DDTOTI
FROM
	LGDAT.OCRH
	INNER JOIN LGDAT.OCRI ON
		DDORD# = DCORD#
	INNER JOIN LGDAT.CUST ON
		BVCUST = DCBCUS
WHERE
	DCSTAT <> 'C' AND
	DDITST  <> 'C'
	--COALESCE(DHPOST,'N')='N'
GROUP BY
	DCPROM, BVCLAS, DCPO, CHAR(DCMDAT), DCSTAT, DCBCUS||' - '||RTRIM(BVNAME) , DCCURR
HAVING
	SUM(DDTOTI) >= 100000
ORDER BY
	CHAR(DCMDAT) ASC
FETCH FIRST 100 ROWS ONLY
