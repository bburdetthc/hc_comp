SELECT
	ASTRTP, CHAR(ASTDAT) AS ASTDAT, ASCOMP, ASCUST, ltrim(rtrim(ASINV#)) AS ASINV#, ASDUAM, ASINAM, DIGITS(ASFSYR)||DIGITS(ASFSPR) AS PER, CHAR(ASPDAT) AS ASPDAT
FROM
	LGDAT.AROP AROP
	INNER JOIN LGDAT.CUST ON
		BVCUST = ASCUST
WHERE
	ASCOMP = '66' AND
	BVARCD = 'F' AND
	DIGITS(ASFSYR)||DIGITS(ASFSPR) <= '1402'

UNION ALL

SELECT
	LOTRTP,
	CHAR(LOIDAT) LOIDAT,
	LOCOMP,
	LOCUST,
	LOINV#,
	-LOAMT,
	0 INVTOT,
	DIGITS(LOFSYR)||DIGITS(LOFSPR) AS PERD,
	CHAR(LOTDAT) LOTDAT
FROM
	LGDAT.ARTRN
	INNER JOIN LGDAT.CUST ON
		BVCUST = LOCUST
WHERE
	LOCOMP = '66' AND
	BVARCD = 'F' AND
	DIGITS(LOFSYR)||DIGITS(LOFSPR) > '1402'
	
	
