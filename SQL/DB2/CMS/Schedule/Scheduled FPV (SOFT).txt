SELECT
	SOFT.*, 
	FLOAT(AQQPPC/AQQTYM)/FLOAT(1-AQSCRP/100)*CASE AQRQBY WHEN 'B' THEN -1 ELSE 1 END*FLOAT(DXQTYR)
FROM
	LGDAT.SOFT SOFT
	INNER JOIN LGDAT.SKTA AP ON
		AP.V6PART = DXPART AND
		AP.V6PLNT = DXPLNT
	LEFT OUTER JOIN LGDAT.METHDR ON
		AQPART = DXPART AND
		AQPLNT = DXPLNT
	LEFT OUTER JOIN LGDAT.STKA AC ON
		AC.V6PART = AQMTLP AND
		AC.V6PLNT = AQPLNT
	LEFT OUTER JOIN LGDAT.ICSTM ICSTM ON 
		CGPART = AC.V6PART AND 
		CGPLNT = AC.V6PLNT 
	LEFT OUTER JOIN LGDAT.ICSTP ICSTP ON 
		CHPART = AC.V6PART AND 
		CHPLNT = AC.V6PLNT 
	LEFT OUTER JOIN LGDAT.ICSTR ICSTR ON 
		Y0PART = AC.V6PART AND 
		Y0PLNT = AC.V6PLNT 
