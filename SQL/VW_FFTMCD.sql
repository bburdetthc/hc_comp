CREATE OR REPLACE VIEW RLARP.VW_FFTMCD ( 
	TERM , 
	DESCR , 
	PAYPERC , 
	PAYDATE , 
	PAYDAYS , 
	DISCP , 
	DISCDAYS,
	VATPWACC ) 
	AS 
SELECT  
	LTRIM(RTRIM(A9)) TERM,  
	LTRIM(RTRIM(A30)) DESCR,  
	FLOAT(SUBSTR(A215,10,3)) PAYPERC,  
	CASE INT(SUBSTR(A215,28,6)) WHEN 0 THEN '' ELSE '20'||SUBSTR(A215,32,2)||'-'||SUBSTR(A215,28,2)||'-'||SUBSTR(A215,30,2) END PAYDATE,  
	INT(SUBSTR(A215,64,3)) PAYDAYS,  
	ROUND(FLOAT(SUBSTR(A215,102,4))/FLOAT(10000),2) DISCP,  
	INT(SUBSTR(A215,84,3)) DISCDAYS ,
	-MIN(
		FLOAT(
			(
				30.0-
				CASE 
					CASE INT(SUBSTR(A215,28,6)) 
						WHEN 0 THEN '' 
						ELSE '20'||SUBSTR(A215,32,2)||'-'||SUBSTR(A215,28,2)||'-'||SUBSTR(A215,30,2) 
					END 
				WHEN '' THEN INT(SUBSTR(A215,64,3)) 
				ELSE 
					DAYS(
					CASE INT(SUBSTR(A215,28,6)) 
						WHEN 0 THEN '' 
						ELSE '20'||SUBSTR(A215,32,2)||'-'||SUBSTR(A215,28,2)||'-'||SUBSTR(A215,30,2) 
					END
					) - 
					DAYS(
						CURRENT_DATE
					) 
				END
			)/30.0
		)*.01,
		FLOAT(30.0 - INT(SUBSTR(A215,84,3)))/30.0*.01-COALESCE(ROUND(FLOAT(SUBSTR(A215,102,4))/FLOAT(10000),2),0.0)
	) VATPWACC
FROM  
	LGDAT.CODE  
WHERE  
	A2 = 'NN'  
	CASE INT(SUBSTR(A215,28,6)) WHEN 0 THEN '9999-99-99' ELSE '20'||SUBSTR(A215,32,2)||'-'||SUBSTR(A215,28,2)||'-'||SUBSTR(A215,30,2) END >= CHAR(CURRENT_DATE)
	RCDFMT VW_FFTMCD  ; 
  
LABEL ON TABLE RLARP.VW_FFTMCD 
	IS 'Mast - Term Codes' ; 
  
GRANT ALTER , DELETE , REFERENCES , SELECT   
ON RLARP.VW_FFTMCD TO PTROWBRIDG WITH GRANT OPTION ;
